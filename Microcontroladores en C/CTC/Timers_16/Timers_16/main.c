/*
 * Timers_16.c
 *
 * Created: 26/03/2018 09:58:01 a. m.
 * Author : LuisFernando
 */ 

#define F_CPU 16000000
#include <util/delay.h>
#include <avr/io.h>
#include <avr/interrupt.h>
uint16_t contador=0,j=0;
//Peril Escala 2 Prescalador a 8
//const uint16_t Notas[926]={7645,65535,7645,65535,11454,65535,11454,65535,7645,65535,7645,65535,11454,65535,11454,65535,7645,65535,7645,65535,11454,65535,11454,65535,7645,65535,7645,65535,7645,65535,7645,65535,6428,65535,6428,65535,6810,65535,6810,65535,7645,65535,7645,65535,7645,65535,7645,65535,11454,65535,11454,65535,10204,65535,11454,65535,10204,65535,11454,65535,12856,65535,7645,65535,7645,65535,7645,65535,7645,65535,6428,65535,6428,65535,6810,65535,6810,65535,7645,65535,7645,65535,7645,65535,7645,65535,11454,65535,11454,65535,10204,65535,11454,65535,10204,65535,11454,65535,12856,65535,7645,65535,7645,65535,7645,65535,7645,65535,6428,65535,6428,65535,6810,65535,6810,65535,7645,65535,7645,65535,7645,65535,7645,65535,11454,65535,11454,65535,10204,65535,11454,65535,10204,65535,11454,65535,12856,65535,7645,65535,7645,65535,7645,65535,7645,65535,6428,65535,6428,65535,6810,65535,6810,65535,7645,65535,7645,65535,7645,65535,7645,65535,11454,65535,11454,65535,10204,65535,11454,65535,10204,65535,11454,65535,12856,65535,7645,65535,7645,65535,11454,65535,11454,65535,7645,65535,7645,65535,11454,65535,11454,65535,7645,65535,7645,65535,11454,65535,11454,65535,7645,65535,7645,65535,11454,65535,11454,65535,3822,65535,3822,65535,3822,65535,3822,65535,3214,65535,3214,65535,3405,65535,3405,65535,3822,65535,3822,65535,3822,65535,3822,65535,5727,65535,5727,65535,5102,65535,5727,65535,5102,65535,5727,65535,6428,65535,3822,65535,3822,65535,3822,65535,3822,65535,3214,65535,3214,65535,3405,65535,3405,65535,3822,65535,3822,65535,3822,65535,3822,65535,5727,65535,5727,65535,5102,65535,5727,65535,5102,65535,5727,65535,6428,65535,5102,65535,5102,65535,5102,65535,5102,65535,5102,65535,5102,65535,5102,65535,5102,65535,4290,65535,4290,65535,4290,65535,4290,65535,4290,65535,4290,65535,4290,65535,4290,65535,3822,65535,3822,65535,3822,65535,3822,65535,3822,65535,3822,65535,3822,65535,3822,65535,4290,65535,4290,65535,4290,65535,4290,65535,4290,65535,5102,65535,5102,65535,5102,65535,5102,65535,5102,65535,5102,65535,5102,65535,5102,65535,4290,65535,4290,65535,4290,65535,4290,65535,4290,65535,4290,65535,4290,65535,4290,65535,3822,65535,3822,65535,3822,65535,3822,65535,3822,65535,3822,65535,3822,65535,3822,65535,4290,65535,4290,65535,4290,65535,4290,65535,4290,65535,5102,65535,5102,65535,5102,65535,5102,65535,5102,65535,5102,65535,5102,65535,5102,65535,4290,65535,4290,65535,4290,65535,4290,65535,4290,65535,4290,65535,4290,65535,4290,65535,3822,65535,3822,65535,3822,65535,3822,65535,3822,65535,3822,65535,3822,65535,3822,65535,4290,65535,4290,65535,4290,65535,4290,65535,4290,65535,5102,65535,5102,65535,5102,65535,5102,65535,5102,65535,5102,65535,5102,65535,5102,65535,4290,65535,4290,65535,4290,65535,4290,65535,4290,65535,4290,65535,4290,65535,4290,65535,3822,65535,3822,65535,3822,65535,3822,65535,3822,65535,3822,65535,3822,65535,3822,65535,4290,65535,4290,65535,4290,65535,4290,65535,4290,65535,5102,65535,5102,65535,3822,65535,3822,65535,3822,65535,3822,65535,3214,65535,3214,65535,3405,65535,3822,65535,3405,65535,3822,65535,4290,65535,3822,65535,3822,65535,3822,65535,3822,65535,3214,65535,3214,65535,3405,65535,3822,65535,3405,65535,3822,65535,4290,65535,3822,65535,3822,65535,3822,65535,3822,65535,3214,65535,3214,65535,3405,65535,3822,65535,3405,65535,3822,65535,4290,65535,3822,65535,3822,65535,3822,65535,3822,65535,3214,65535,3214,65535,2863,65535,2863,65535,2863,65535,2863,65535,2551,65535,2551,65535,2408,65535,2408,65535,2551,65535,2551,65535,2863,65535,2863,65535,2863,65535,2863,65535,3214,65535,3214,65535,3214,65535,3214,65535,5727,65535,7645,65535,7645,65535,8581,65535,8581,65535,7645,65535,7645,65535,11454,65535,11454,65535,7645,65535,7645,65535,11454,65535,11454,65535,7645,65535,7645,65535,11454,65535,11454,65535,5102,65535,5102,65535,5102,65535,5102,65535,5102,65535,5102,65535,5102,65535,5102,65535,4290,65535,4290,65535,4290,65535,4290,65535,4290,65535,4290,65535,4290,65535,4290,65535,3822,65535,3822,65535,3822,65535,3822,65535,3822,65535,3822,65535,3822,65535,3822,65535,4290,65535,4290,65535,4290,65535,4290,65535,4290,65535,4290,65535,4290,65535,4290,65535,5102,65535,5102,65535,5102,65535,5102,65535,5102,65535,5102,65535,5102,65535,5102,65535,4290,65535,4290,65535,4290,65535,4290,65535,4290,65535,4290,65535,4290,65535,4290,65535,3822,65535,3822,65535,3822,65535,3822,65535,3822,65535,3822,65535,3822,65535,3822,65535,4290,65535,4290,65535,4290,65535,4290,65535,4290,65535,4290,65535,4290,65535,4290,65535,5102,65535,5102,65535,5102,65535,5102,65535,5102,65535,5102,65535,5102,65535,5102,65535,4290,65535,4290,65535,4290,65535,4290,65535,4290,65535,4290,65535,4290,65535,4290,65535,3822,65535,3822,65535,3822,65535,3822,65535,3822,65535,3822,65535,3822,65535,3822,65535,4290,65535,4290,65535,4290,65535,4290,65535,4290,65535,4290,65535,4290,65535,4290,65535,5102,65535,5102,65535,5102,65535,5102,65535,5102,65535,5102,65535,5102,65535,5102,65535,4290,65535,4290,65535,4290,65535,4290,65535,4290,65535,4290,65535,4290,65535,4290,65535,3822,65535,3822,65535,3822,65535,3822,65535,3822,65535,3822,65535,3822,65535,3822,65535,4290,65535,4290,65535,4290,65535,4290,65535,4290,65535,4290,65535,4290,65535,4290,65535,65535,65535};
//Peril Escala 3 Prescalador a 8
const uint16_t Notas[926]={3822,65535,3822,65535,5727,65535,5727,65535,3822,65535,3822,65535,5727,65535,5727,65535,3822,65535,3822,65535,5727,65535,5727,65535,3822,65535,3822,65535,3822,65535,3822,65535,3214,65535,3214,65535,3405,65535,3405,65535,3822,65535,3822,65535,3822,65535,3822,65535,5727,65535,5727,65535,5102,65535,5727,65535,5102,65535,5727,65535,6428,65535,3822,65535,3822,65535,3822,65535,3822,65535,3214,65535,3214,65535,3405,65535,3405,65535,3822,65535,3822,65535,3822,65535,3822,65535,5727,65535,5727,65535,5102,65535,5727,65535,5102,65535,5727,65535,6428,65535,3822,65535,3822,65535,3822,65535,3822,65535,3214,65535,3214,65535,3405,65535,3405,65535,3822,65535,3822,65535,3822,65535,3822,65535,5727,65535,5727,65535,5102,65535,5727,65535,5102,65535,5727,65535,6428,65535,3822,65535,3822,65535,3822,65535,3822,65535,3214,65535,3214,65535,3405,65535,3405,65535,3822,65535,3822,65535,3822,65535,3822,65535,5727,65535,5727,65535,5102,65535,5727,65535,5102,65535,5727,65535,6428,65535,3822,65535,3822,65535,5727,65535,5727,65535,3822,65535,3822,65535,5727,65535,5727,65535,3822,65535,3822,65535,5727,65535,5727,65535,3822,65535,3822,65535,5727,65535,5727,65535,1911,65535,1911,65535,1911,65535,1911,65535,1607,65535,1607,65535,1703,65535,1703,65535,1911,65535,1911,65535,1911,65535,1911,65535,2863,65535,2863,65535,2551,65535,2863,65535,2551,65535,2863,65535,3214,65535,1911,65535,1911,65535,1911,65535,1911,65535,1607,65535,1607,65535,1703,65535,1703,65535,1911,65535,1911,65535,1911,65535,1911,65535,2863,65535,2863,65535,2551,65535,2863,65535,2551,65535,2863,65535,3214,65535,2551,65535,2551,65535,2551,65535,2551,65535,2551,65535,2551,65535,2551,65535,2551,65535,2145,65535,2145,65535,2145,65535,2145,65535,2145,65535,2145,65535,2145,65535,2145,65535,1911,65535,1911,65535,1911,65535,1911,65535,1911,65535,1911,65535,1911,65535,1911,65535,2145,65535,2145,65535,2145,65535,2145,65535,2145,65535,2551,65535,2551,65535,2551,65535,2551,65535,2551,65535,2551,65535,2551,65535,2551,65535,2145,65535,2145,65535,2145,65535,2145,65535,2145,65535,2145,65535,2145,65535,2145,65535,1911,65535,1911,65535,1911,65535,1911,65535,1911,65535,1911,65535,1911,65535,1911,65535,2145,65535,2145,65535,2145,65535,2145,65535,2145,65535,2551,65535,2551,65535,2551,65535,2551,65535,2551,65535,2551,65535,2551,65535,2551,65535,2145,65535,2145,65535,2145,65535,2145,65535,2145,65535,2145,65535,2145,65535,2145,65535,1911,65535,1911,65535,1911,65535,1911,65535,1911,65535,1911,65535,1911,65535,1911,65535,2145,65535,2145,65535,2145,65535,2145,65535,2145,65535,2551,65535,2551,65535,2551,65535,2551,65535,2551,65535,2551,65535,2551,65535,2551,65535,2145,65535,2145,65535,2145,65535,2145,65535,2145,65535,2145,65535,2145,65535,2145,65535,1911,65535,1911,65535,1911,65535,1911,65535,1911,65535,1911,65535,1911,65535,1911,65535,2145,65535,2145,65535,2145,65535,2145,65535,2145,65535,2551,65535,2551,65535,1911,65535,1911,65535,1911,65535,1911,65535,1607,65535,1607,65535,1703,65535,1911,65535,1703,65535,1911,65535,2145,65535,1911,65535,1911,65535,1911,65535,1911,65535,1607,65535,1607,65535,1703,65535,1911,65535,1703,65535,1911,65535,2145,65535,1911,65535,1911,65535,1911,65535,1911,65535,1607,65535,1607,65535,1703,65535,1911,65535,1703,65535,1911,65535,2145,65535,1911,65535,1911,65535,1911,65535,1911,65535,1607,65535,1607,65535,1432,65535,1432,65535,1432,65535,1432,65535,1276,65535,1276,65535,1204,65535,1204,65535,1276,65535,1276,65535,1432,65535,1432,65535,1432,65535,1432,65535,1607,65535,1607,65535,1607,65535,1607,65535,2863,65535,3822,65535,3822,65535,4290,65535,4290,65535,3822,65535,3822,65535,5727,65535,5727,65535,3822,65535,3822,65535,5727,65535,5727,65535,3822,65535,3822,65535,5727,65535,5727,65535,2551,65535,2551,65535,2551,65535,2551,65535,2551,65535,2551,65535,2551,65535,2551,65535,2145,65535,2145,65535,2145,65535,2145,65535,2145,65535,2145,65535,2145,65535,2145,65535,1911,65535,1911,65535,1911,65535,1911,65535,1911,65535,1911,65535,1911,65535,1911,65535,2145,65535,2145,65535,2145,65535,2145,65535,2145,65535,2145,65535,2145,65535,2145,65535,2551,65535,2551,65535,2551,65535,2551,65535,2551,65535,2551,65535,2551,65535,2551,65535,2145,65535,2145,65535,2145,65535,2145,65535,2145,65535,2145,65535,2145,65535,2145,65535,1911,65535,1911,65535,1911,65535,1911,65535,1911,65535,1911,65535,1911,65535,1911,65535,2145,65535,2145,65535,2145,65535,2145,65535,2145,65535,2145,65535,2145,65535,2145,65535,2551,65535,2551,65535,2551,65535,2551,65535,2551,65535,2551,65535,2551,65535,2551,65535,2145,65535,2145,65535,2145,65535,2145,65535,2145,65535,2145,65535,2145,65535,2145,65535,1911,65535,1911,65535,1911,65535,1911,65535,1911,65535,1911,65535,1911,65535,1911,65535,2145,65535,2145,65535,2145,65535,2145,65535,2145,65535,2145,65535,2145,65535,2145,65535,2551,65535,2551,65535,2551,65535,2551,65535,2551,65535,2551,65535,2551,65535,2551,65535,2145,65535,2145,65535,2145,65535,2145,65535,2145,65535,2145,65535,2145,65535,2145,65535,1911,65535,1911,65535,1911,65535,1911,65535,1911,65535,1911,65535,1911,65535,1911,65535,2145,65535,2145,65535,2145,65535,2145,65535,2145,65535,2145,65535,2145,65535,2145,65535,65535,65535};
const uint16_t Tiempo[926]={125,63,250,63,125,63,500,63,125,63,250,63,125,63,500,63,125,63,250,63,125,63,500,63,125,63,250,63,125,63,500,63,125,63,250,63,125,63,500,63,125,63,250,63,125,63,500,63,125,63,250,63,63,63,63,63,63,63,63,63,250,63,125,63,250,63,125,63,500,63,125,63,250,63,125,63,500,63,125,63,250,63,125,63,500,63,125,63,250,63,63,63,63,63,63,63,63,63,250,63,125,63,250,63,125,63,500,63,125,63,250,63,125,63,500,63,125,63,250,63,125,63,500,63,125,63,250,63,63,63,63,63,63,63,63,63,250,63,125,63,250,63,125,63,500,63,125,63,250,63,125,63,500,63,125,63,250,63,125,63,500,63,125,63,250,63,63,63,63,63,63,63,63,63,250,63,125,63,250,63,125,63,500,63,125,63,250,63,125,63,500,63,125,63,250,63,125,63,500,63,125,63,250,63,125,63,500,63,125,63,250,63,125,63,500,63,125,63,250,63,125,63,500,63,125,63,250,63,125,63,500,63,125,63,250,63,63,63,63,63,63,63,63,63,250,63,125,63,250,63,125,63,500,63,125,63,250,63,125,63,500,63,125,63,250,63,125,63,500,63,125,63,250,63,63,63,63,63,63,63,63,63,250,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,250,63,125,63,250,63,125,63,500,63,125,63,250,63,63,63,63,63,63,63,63,63,250,63,125,63,250,63,125,63,500,63,125,63,250,63,63,63,63,63,63,63,63,63,250,63,125,63,250,63,125,63,500,63,125,63,250,63,63,63,63,63,63,63,63,63,250,63,125,63,250,63,125,63,500,63,125,63,250,63,125,63,500,63,125,63,250,63,125,63,500,63,125,63,250,63,125,63,500,63,125,63,250,63,125,63,500,63,125,63,250,63,125,63,2000,63,250,63,125,63,250,63,125,63,500,63,125,63,250,63,125,63,250,63,125,63,250,63,125,63,250,63,125,63,250,63,125,63,250,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,125,63,1500,63,500,63,500,63};

ISR(TIMER0_COMPA_vect){
	j++;
	if (j>Tiempo[contador])
	{
	 if (Notas[contador]==65535)
	 {
	  TCCR1A=(1<<COM1A1)|(0<<COM1A0)|(0<<COM1B1)|(0<<COM1B0)|(0<<COM1C1)|(0<<COM1C0)|(0<<WGM11)|(0<<WGM10);//Modo CTC cambiar a bajo.
	 }
	 else{
	  TCCR1A=(0<<COM1A1)|(1<<COM1A0)|(0<<COM1B1)|(0<<COM1B0)|(0<<COM1C1)|(0<<COM1C0)|(0<<WGM11)|(0<<WGM10);//Modo CTC alternar estados.	 
	 }
	 OCR1A=Notas[contador];
	 j=0;
	 contador++;
	 if(contador>926){
		 contador=0;}
	}	
}
int main(void)
{
	DDRB=(1<<PB5);
	///Configuracion Timer 0 a 1ms
	TCCR0A=(0<<COM0A1)|(0<<COM0A0)|(0<<COM0B1)|(0<<COM0B0)|(0<<3)|(0<<2)|(1<<WGM01)|(0<<WGM00);//Desconectar OC0A y Modo CTC.
	TCCR0B=(0<<FOC0A)|(0<<FOC0B)|(0<<5)|(0<<4)|(0<<WGM02)|(0<<CS02)|(1<<CS01)|(1<<CS00);//Modo CTC y Prescalador a 64.
	TIMSK0=(0<<7)|(0<<6)|(0<<5)|(0<<4)|(0<<3)|(0<<OCIE0B)|(1<<OCIE0A)|(0<<TOIE0);//Interrupción solo por OCIE0A.
	TCNT0=0x00;
	OCR0A=249;
	OCR0B=0x00;
	//Configuracion Timer 1 en CTC
	TCCR1A=(0<<COM1A1)|(1<<COM1A0)|(0<<COM1B1)|(0<<COM1B0)|(0<<COM1C1)|(0<<COM1C0)|(0<<WGM11)|(0<<WGM10);//Conectar OC1A y Modo CTC.
    TCCR1B=(0<<ICNC1)|(0<<ICES1)|(0<<5)|(0<<WGM13)|(1<<WGM12)|(0<<CS12)|(1<<CS11)|(0<<CS10);//Modo CTC y Prescalador a 8.
    TCCR1C=(0<<FOC1A)|(0<<FOC1B)|(0<<FOC1C)|(0<<4)|(0<<3)|(0<<2)|(0<<1)|(0<<0);//Sin forzar comparaciones.
	TIMSK1=(0<<7)|(0<<6)|(0<<ICIE1)|(0<<4)|(0<<OCIE1C)|(0<<OCIE1B)|(0<<OCIE1A)|(0<<TOIE1);//Sin interrupciones.
	TCNT1=0x0000;
	ICR1=0x0000;
	OCR1A=0X0000;
	OCR2A=0x0000;
	OCR1C=0x0000;
	sei();
	/* Replace with your application code */
	while (1)
	{
		
	}
	while (1)
	{
		
	}
}

